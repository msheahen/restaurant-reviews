function getParameterByName(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),r=a.exec(e);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}function initRestaurantDetails(){var t=getParameterByName("restaurant_id");fetch("./assets/data/restaurants.json").then(function(t){return t.json()})["catch"](function(t){return t}).then(function(e){var a=e.restaurants.filter(function(e){return e.id===t}),r=a[0],n=0;r.reviews.forEach(function(t){n+=parseInt(t.stars)}),r.rating=n/r.reviews.length;var s=r.reviews,i=$("#restaurant-details").html(),c=Handlebars.compile(i);$(".restaurantNav").append(c(r));var o=$("#ratings-list").html(),l=Handlebars.compile(o);$(".ratingsNav").append(l(s))})["catch"](function(t){console.log(t)})}function printStars(t){for(var e="",a=0;a<t;a++)e+="<span class='star-icon'>★</span>";for(a=t;a<5;a++)e+="<span class='star-icon'>☆</span>";return e}var path=window.location.pathname,page=path.split("/").pop();Handlebars.registerHelper("everyOther",function(t,e,a){return++t%e?a.inverse(this):a.fn(this)}),Handlebars.registerHelper("printStars",function(t){for(var e=Math.floor(t),a="",r=0;r<e;r++)a+="<span class='star-icon'>★</span>";for(r=e;r<5;r++)a+="<span class='star-icon'>☆</span>";return new Handlebars.SafeString(a)}),Handlebars.registerHelper("printDollarSigns",function(t){for(var e=" ",a=0;a<t;a++)e+="$";return new Handlebars.SafeString(e)}),Handlebars.registerHelper("formatTime",function(t){var e,a=t.slice(0,-3);return a>=13?(a-=12,e="PM"):e="AM",a+":00 "+e}),$(document).ready(function(){"/restaurant-view.html"==path&&(initRestaurantDetails(),$("#new-review").submit(function(t){t.preventDefault();var e=$("#review-comments").val(),a=$("#reviewer-name").val(),r=$('input[name="rating"]:checked').val();if(r&&a&&e){var n=new Date,s='<div class="row"><div class="col-xs-12 col-md-6"><div class="card"><div class="review-masthead"><h4 class="card-title review-title text-center">'+a+'</h4><p class="card-text text-center">'+printStars(r)+'</p></div><div class="card-block"><p class="card-text date-text">'+n.toLocaleDateString()+'</p><p class="card-text">'+e+"</p></div></div></div></div>";$(".ratingsNav").append(s),$("#review-modal").modal("hide")}}),$("#review-modal").on("shown.bs.modal",function(){$("#review-modal").removeAttr("aria-hidden"),$("#reviewer-name").focus()}))}),$(document).ready(function(){"/"==path&&(fetch("./assets/data/restaurants.json").then(function(t){return t.json()})["catch"](function(t){console.log(t)}).then(function(t){t.restaurants.forEach(function(t){var e=0;t.reviews.forEach(function(t){e+=parseInt(t.stars)}),t.rating=e/t.reviews.length});var e=$("#restaurant-card-template").html(),a=Handlebars.compile(e);$(".restaurant-list").append(a(t.restaurants))})["catch"](function(t){console.log(t)}),$("#filter-restaurants").submit(function(t){t.preventDefault(),fetch("./assets/data/restaurants.json").then(function(t){return t.json()})["catch"](function(t){console.log(t)}).then(function(t){t.restaurants.forEach(function(t){var e=0;t.reviews.forEach(function(t){e+=parseInt(t.stars)}),t.rating=e/t.reviews.length});var e=$("#maximum-price").val(),a=$('input[name="rating"]:checked').val(),r=$("#cuisine-type").val();return"all"==r?t.restaurants.filter(function(t){return t.price<=e&&t.rating>=a}):t.restaurants.filter(function(t){return t.price<=e&&t.rating>=a&&t.cuisine==r})})["catch"](function(t){console.log(t)}).then(function(t){if($(".restaurant-list").html(""),0===t.length)$(".restaurant-list").html('<div class="alert alert-danger">There are no restaurants that meet that criteria.  Please try again.</div>');else{var e=$("#restaurant-card-template").html(),a=Handlebars.compile(e);$(".restaurant-list").append(a(t))}})["catch"](function(t){console.log(t)})}))});